"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t,o){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e(t,o):"function"==typeof define&&define.amd?define((function(){return e(t,o)})):t.Noose=e(t,o)}((function(e,t){function o(){}var r={container:"body",classes:{noose:"",selected:"selected"},enabled:!0,mode:"touch",scroll:10,scrollEdge:10,scrollbar:17,select:"*",start:o,stop:o,style:{border:"1px dotted #000",zIndex:1e3},throttle:200};return function(){function o(n,s){_classCallCheck(this,o);var l=this;if("object"!==_typeof(n)||null==n||n instanceof Element||(s=n,n=null),s=l.opts=Object.assign({},r,s),("string"==typeof n||n instanceof Element)&&(s.container=n),s.container instanceof Element)l.containers=[s.container];else{if("string"!=typeof s.container)throw new Error("Invalid container option");l.containers=t.querySelectorAll(s.container)}l.coors={pointer:{start:null,end:null},noose:{top:null,bottom:null},container:{}};var c=l.noose=t.createElement("div");c.style.position="absolute",c.style.zIndex=l.opts.style.zIndex,c.style.border=l.opts.style.border,s.classes.noose&&c.classList.add(l.opts.classes.noose);var a=!1,i=!1;return l._onStart=function(t){if(l.opts.enabled&&(!a||t.currentTarget!==l.currentTarget)&&("mousedown"!==t.type||1===t.which)){a=!0,l.currentTarget=t.currentTarget;var o=e.getComputedStyle(l.currentTarget);"static"===o.position&&console.warn("Container is not a positioned element. This may cause issues positioning the noose and/or selecting elements.");var r=l.coors.container,n=l.coors.pointer,s=l.coors.noose;if(l.opts.scroll>0&&l.opts.scrollEdge>0?(r.scrollX=("auto"===o.overflowX||"scroll"===o.overflowX)&&l.currentTarget.scrollHeight>l.currentTarget.clientHeight,r.scrollY=("auto"===o.overflowY||"scroll"===o.overflowY)&&l.currentTarget.scrollWidth>l.currentTarget.clientWidth):(r.scrollX=!1,r.scrollY=!1),r.maxScrollY=r.scrollY&&l.currentTarget.scrollHeight-l.currentTarget.clientHeight||0,r.maxScrollX=r.scrollX&&l.currentTarget.scrollWidth-l.currentTarget.clientWidth||0,n.start=null,s.start=null,l.updateContainerPosition().updatePointerPosition(t),l.opts.scrollbar&&(r.scrollX&&n.start.x>r.x+r.w-l.opts.scrollbar||r.scrollY&&n.start.y>r.y+r.h-l.opts.scrollbar))return void(a=!1);if(l.noose.style.display="none",!1===l.opts.start.apply(l,[t,l.coors])||t.defaultPrevented)return void(a=!1);l.currentTarget.appendChild(l.noose)}},l._onMove=function(e){if(l.opts.enabled&&a&&e.currentTarget===l.currentTarget){e.preventDefault(),"scroll"!==e.type&&l.updatePointerPosition(e),l.updateContainerPosition().updateNoosePosition();var t=l.coors.noose.top,o=l.coors.noose.bottom;l.noose.style.left=t.x+"px",l.noose.style.top=t.y+"px",l.noose.style.width=o.x-t.x+"px",l.noose.style.height=o.y-t.y+"px",l.noose.style.display="block";var r=l.coors.container,n=l.coors.pointer.end;r.scrollY&&n.y-r.y<10?l.currentTarget.scrollTop-=l.opts.scroll:r.scrollY&&l.currentTarget.scrollTop<r.maxScrollY&&r.y+r.h-n.y<10?l.currentTarget.scrollTop+=l.opts.scroll:r.scrollX&&n.x-r.x<10?l.currentTarget.scrollLeft-=l.opts.scroll:r.scrollX&&l.currentTarget.scrollLeft<r.maxScrollX&&r.x+r.w-n.x<10&&(l.currentTarget.scrollLeft+=l.opts.scroll),l.opts.throttle?i||(i=!0,setTimeout((function(){l.compute(),i=!1}),l.opts.throttle)):l.compute()}},l._onEnd=function(e){l.opts.enabled&&a&&("mouseup"!==e.type||1===e.which)&&(a=!1,e.currentTarget===l.currentTarget&&(l.updateContainerPosition().updatePointerPosition(e).updateNoosePosition(),l.compute(),setTimeout((function(){l.opts.stop.apply(l,[e,l.coors,l.selected])}),0),l.currentTarget.removeChild(l.noose)))},Array.prototype.forEach.call(l.containers,(function(e){e.addEventListener("mousedown",l._onStart),e.addEventListener("touchstart",l._onStart),e.addEventListener("mousemove",l._onMove),e.addEventListener("touchmove",l._onMove),e.addEventListener("scroll",l._onMove),e.addEventListener("mouseup",l._onEnd),e.addEventListener("touchend",l._onEnd)})),l}return _createClass(o,[{key:"destroy",value:function(){var e=this;return e.containers.forEach((function(t){t.removeEventListener("mousedown",e._onStart),t.removeEventListener("touchstart",e._onStart),t.removeEventListener("mousemove",e._onMove),t.removeEventListener("touchmove",e._onMove),t.removeEventListener("scroll",e._onMove),t.removeEventListener("mouseup",e._onEnd),t.removeEventListener("touchend",e._onEnd)})),e}},{key:"updateContainerPosition",value:function(){var t=this.currentTarget,o=this.coors.container,r=t.getBoundingClientRect();return o.x=r.left+e.pageXOffset,o.y=r.top+e.pageYOffset,o.w=r.width,o.h=r.height,this}},{key:"updatePointerPosition",value:function(e){var t=e&&e.touches&&e.touches[0]||e,o=this.coors.pointer;if(t&&"number"==typeof t.pageX){var r={x:t.pageX,y:t.pageY};o.start||(o.start=r),o.end=r}return this}},{key:"updateNoosePosition",value:function(){var e=this.currentTarget,t=this.coors.pointer,o=this.coors.container,r=this.coors.noose;r.start||(r.start={x:t.start.x-o.x+e.scrollLeft,y:t.start.y-o.y+e.scrollTop});var n=t.end.x-o.x+e.scrollLeft,s=t.end.y-o.y+e.scrollTop;return r.top={x:Math.min(r.start.x,n),y:Math.min(r.start.y,s)},r.bottom={x:Math.max(r.start.x,n),y:Math.max(r.start.y,s)},this}},{key:"compute",value:function(){var t=this;if(t.opts.select){var o=t.opts.classes.selected,r=t.currentTarget.querySelectorAll(t.opts.select),n=t.coors.noose.top,s=t.coors.noose.bottom,l=t.coors.container.x,c=t.coors.container.y;t.selected=[],Array.prototype.forEach.call(r,(function(r){if(r!==t.noose){var a=r.getBoundingClientRect(),i=a.left+e.pageXOffset-l+t.currentTarget.scrollLeft,u=a.top+e.pageYOffset-c+t.currentTarget.scrollTop,p=a.width+i,d=a.height+u;("fit"===t.opts.mode?n.x<=i&&n.y<=u&&s.x>=p&&s.y>=d:!(n.x>p||n.y>d||s.x<i||s.y<u))?(o&&r.classList.add(o),t.selected.push(r)):o&&r.classList.remove(o)}}))}return t}}],[{key:"version",get:function(){return"1.1.1"}}]),o}()}),window,document);
//# sourceMappingURL=noose.es5.js.map
