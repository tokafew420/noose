"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t,o){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e(t,o):"function"==typeof define&&define.amd?define((function(){return e(t,o)})):t.Noose=e(t,o)}((function(e,t){function o(){}var n={classes:{noose:"noose",selected:"selected"},compute:!0,container:"body",enabled:!0,mode:"touch",scroll:10,scrollEdge:10,scrollbar:17,select:"*",start:o,stop:o,style:{border:"1px dotted #000",zIndex:1e3},throttle:200};return function(){function o(r,s){_classCallCheck(this,o);var l=this;if("object"!==_typeof(r)||null==r||r instanceof HTMLElement||(s=r,r=null),s=l.opts=Object.assign({},n,s),("string"==typeof r||r instanceof HTMLElement)&&(s.container=r),s.container instanceof HTMLElement)l.containers=[s.container];else{if("string"!=typeof s.container)throw new Error("Invalid container option");l.containers=t.querySelectorAll(s.container)}l.coors={pointer:{start:null,end:{}},noose:{top:null,bottom:null},container:{}};var c=l.noose=t.createElement("div");c.style.position="absolute",c.style.zIndex=s.style.zIndex,c.style.border=s.style.border,s.classes.noose&&c.classList.add(s.classes.noose);var i=!1,a=!1;return l._onStart=function(t){if(s.enabled&&(!i||t.currentTarget!==l.currentTarget)&&("mousedown"!==t.type||1===t.which)){i=!0;var o=l.currentTarget=t.currentTarget,n=l.coors.container,r=l.coors.pointer,a=l.coors.noose,u=e.getComputedStyle(o);if("static"===u.position&&console.warn("Container is not a positioned element. This may cause issues positioning the noose and/or selecting elements."),s.scroll>0&&s.scrollEdge>0?(n.scrollX=("auto"===u.overflowX||"scroll"===u.overflowX)&&o.scrollHeight>o.clientHeight,n.scrollY=("auto"===u.overflowY||"scroll"===u.overflowY)&&o.scrollWidth>o.clientWidth):(n.scrollX=!1,n.scrollY=!1),n.maxScrollY=n.scrollY&&o.scrollHeight-o.clientHeight||0,n.maxScrollX=n.scrollX&&o.scrollWidth-o.clientWidth||0,r.start=null,a.start=null,l.updateContainerPosition().updatePointerPosition(t),s.scrollbar&&(n.scrollX&&r.start.x>n.x+n.w-s.scrollbar||n.scrollY&&r.start.y>n.y+n.h-s.scrollbar))return void(i=!1);if(c.style.display="none",!1===s.start.apply(l,[t,l.coors]))return void(i=!1);o.appendChild(c)}},l._onMove=function(e){if(s.enabled&&i&&e.currentTarget===l.currentTarget){e.cancelable&&e.preventDefault(),"scroll"!==e.type&&l.updatePointerPosition(e),l.updateContainerPosition().updateNoosePosition();var t=l.coors.noose.top,o=l.coors.noose.bottom;c.style.left=t.x+"px",c.style.top=t.y+"px",c.style.width=o.x-t.x+"px",c.style.height=o.y-t.y+"px",c.style.display="block";var n=l.currentTarget,r=l.coors.container,u=l.coors.pointer.end;r.scrollY&&u.y-r.y<s.scrollEdge?n.scrollTop-=s.scroll:r.scrollY&&n.scrollTop<r.maxScrollY&&r.y+r.h-u.y<s.scrollEdge?n.scrollTop+=s.scroll:r.scrollX&&u.x-r.x<s.scrollEdge?n.scrollLeft-=s.scroll:r.scrollX&&n.scrollLeft<r.maxScrollX&&r.x+r.w-u.x<s.scrollEdge&&(n.scrollLeft+=s.scroll),s.compute&&(s.throttle?a||(a=!0,setTimeout((function(){l.compute(),a=!1}),s.throttle)):l.compute())}},l._onEnd=function(e){l.opts.enabled&&i&&("mouseup"!==e.type||1===e.which)&&(i=!1,e.currentTarget===l.currentTarget&&(l.updateContainerPosition().updatePointerPosition(e).updateNoosePosition(),s.compute&&l.compute(),setTimeout((function(){s.stop.apply(l,[e,l.coors,l.selected])}),0),l.currentTarget.removeChild(c)))},Array.prototype.forEach.call(l.containers,(function(e){e.addEventListener("mousedown",l._onStart),e.addEventListener("touchstart",l._onStart,!1),e.addEventListener("mousemove",l._onMove),e.addEventListener("touchmove",l._onMove,!1),e.addEventListener("scroll",l._onMove),e.addEventListener("mouseup",l._onEnd),e.addEventListener("touchend",l._onEnd,!1),e.noose=l})),l}return _createClass(o,[{key:"destroy",value:function(){var e=this;return e.containers.forEach((function(t){t.removeEventListener("mousedown",e._onStart),t.removeEventListener("touchstart",e._onStart),t.removeEventListener("mousemove",e._onMove),t.removeEventListener("touchmove",e._onMove),t.removeEventListener("scroll",e._onMove),t.removeEventListener("mouseup",e._onEnd),t.removeEventListener("touchend",e._onEnd),delete t.noose})),e.noose.remove(),e.noose=null,e}},{key:"updateContainerPosition",value:function(){var t=this.coors.container,o=this.currentTarget.getBoundingClientRect();return t.x=o.left+e.pageXOffset,t.y=o.top+e.pageYOffset,t.w=o.width,t.h=o.height,this}},{key:"updatePointerPosition",value:function(e){var t=e&&e.touches&&e.touches[0]||e,o=this.coors.pointer;return t&&"number"==typeof t.pageX&&(o.end={x:t.pageX,y:t.pageY},o.start||(o.start=o.end)),this}},{key:"updateNoosePosition",value:function(){var e=this.currentTarget,t=this.coors.pointer,o=this.coors.container,n=this.coors.noose,r=Math.max(t.end.x-o.x+e.scrollLeft,0),s=Math.max(t.end.y-o.y+e.scrollTop,0);return n.start||(n.start={x:r,y:s}),n.top={x:Math.min(n.start.x,r),y:Math.min(n.start.y,s)},n.bottom={x:Math.min(Math.max(n.start.x,r),e.scrollWidth),y:Math.min(Math.max(n.start.y,s),e.scrollHeight)},this}},{key:"compute",value:function(){var t=this;if(t.opts.select){var o=t.opts.classes.selected,n=t.currentTarget.querySelectorAll(t.opts.select),r=t.coors.noose.top,s=t.coors.noose.bottom,l=t.coors.container.x,c=t.coors.container.y;t.selected=[],Array.prototype.forEach.call(n,(function(n){if(n!==t.noose){var i=n.getBoundingClientRect(),a=i.left+e.pageXOffset-l+t.currentTarget.scrollLeft,u=i.top+e.pageYOffset-c+t.currentTarget.scrollTop,d=i.width+a,p=i.height+u;("fit"===t.opts.mode?r.x<=a&&r.y<=u&&s.x>=d&&s.y>=p:!(r.x>d||r.y>p||s.x<a||s.y<u))?(o&&n.classList.add(o),t.selected.push(n)):o&&n.classList.remove(o)}}))}return t}}],[{key:"version",get:function(){return"1.1.4"}}]),o}()}),window,document);
//# sourceMappingURL=noose.es5.js.map
