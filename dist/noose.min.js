!function(t,e,o){"object"==typeof exports?module.exports=t(e,o):"function"==typeof define&&define.amd?define(()=>t(e,o)):e.Noose=t(e,o)}((function(t,e){"use strict";function o(){}const r={container:"body",classes:{noose:"",selected:"selected"},enabled:!0,mode:"touch",scroll:10,scrollEdge:10,scrollbar:17,select:"*",start:o,stop:o,style:{border:"1px dotted #000",zIndex:1e3},throttle:200};return class{constructor(o,s){var n=this;if("object"!=typeof o||null==o||o instanceof Element||(s=o,o=null),s=n.opts=Object.assign({},r,s),("string"==typeof o||o instanceof Element)&&(s.container=o),s.container instanceof Element)n.containers=[s.container];else{if("string"!=typeof s.container)throw new Error("Invalid container option");n.containers=e.querySelectorAll(s.container)}n.coors={pointer:{start:null,end:null},noose:{top:null,bottom:null},container:{}};var l=n.noose=e.createElement("div");l.style.position="absolute",l.style.zIndex=n.opts.style.zIndex,l.style.border=n.opts.style.border,s.classes.noose&&l.classList.add(n.opts.classes.noose);var c=!1,a=!1;return n._onStart=function(e){if(1===e.which&n.opts.enabled&&(!c||e.currentTarget!==n.currentTarget)){c=!0,n.currentTarget=e.currentTarget;var o=t.getComputedStyle(n.currentTarget);"static"===o.position&&console.warn("Container is not a positioned element. This may cause issues positioning the noose and/or selecting elements.");var r=n.coors.container,s=n.coors.pointer,l=n.coors.noose;if(n.opts.scroll>0&&n.opts.scrollEdge>0?(r.scrollX=("auto"===o.overflowX||"scroll"===o.overflowX)&&n.currentTarget.scrollHeight>n.currentTarget.clientHeight,r.scrollY=("auto"===o.overflowY||"scroll"===o.overflowY)&&n.currentTarget.scrollWidth>n.currentTarget.clientWidth):(r.scrollX=!1,r.scrollY=!1),r.maxScrollY=r.scrollY&&n.currentTarget.scrollHeight-n.currentTarget.clientHeight||0,r.maxScrollX=r.scrollX&&n.currentTarget.scrollWidth-n.currentTarget.clientWidth||0,s.start=null,l.start=null,n.updateContainerPosition().updatePointerPosition(e),n.opts.scrollbar&&(r.scrollX&&s.start.x>r.x+r.w-n.opts.scrollbar||r.scrollY&&s.start.y>r.y+r.h-n.opts.scrollbar))return void(c=!1);if(n.noose.style.display="none",!1===n.opts.start.apply(n,[e,n.coors])||e.defaultPrevented)return void(c=!1);n.currentTarget.appendChild(n.noose)}},n._onMove=function(t){if(n.opts.enabled&&c&&t.currentTarget===n.currentTarget){t.preventDefault(),"scroll"!==t.type&&n.updatePointerPosition(t),n.updateContainerPosition().updateNoosePosition();var e=n.coors.noose.top,o=n.coors.noose.bottom;n.noose.style.left=e.x+"px",n.noose.style.top=e.y+"px",n.noose.style.width=o.x-e.x+"px",n.noose.style.height=o.y-e.y+"px",n.noose.style.display="block";var r=n.coors.container,s=n.coors.pointer.end;r.scrollY&&s.y-r.y<10?n.currentTarget.scrollTop-=n.opts.scroll:r.scrollY&&n.currentTarget.scrollTop<r.maxScrollY&&r.y+r.h-s.y<10?n.currentTarget.scrollTop+=n.opts.scroll:r.scrollX&&s.x-r.x<10?n.currentTarget.scrollLeft-=n.opts.scroll:r.scrollX&&n.currentTarget.scrollLeft<r.maxScrollX&&r.x+r.w-s.x<10&&(n.currentTarget.scrollLeft+=n.opts.scroll),n.opts.throttle?a||(a=!0,setTimeout((function(){n.compute(),a=!1}),n.opts.throttle)):n.compute()}},n._onEnd=function(t){1===t.which&&n.opts.enabled&&c&&(c=!1,t.currentTarget===n.currentTarget&&(n.updateContainerPosition().updatePointerPosition(t).updateNoosePosition(),n.compute(),setTimeout((function(){n.opts.stop.apply(n,[t,n.coors,n.selected])}),0),n.currentTarget.removeChild(n.noose)))},Array.prototype.forEach.call(n.containers,(function(t){t.addEventListener("mousedown",n._onStart),t.addEventListener("mousemove",n._onMove),t.addEventListener("scroll",n._onMove),t.addEventListener("mouseup",n._onEnd)})),n}destroy(){var t=this;return t.containers.forEach((function(e){e.removeEventListener("mousedown",t._onStart),e.removeEventListener("mousemove",t._onMove),e.removeEventListener("scroll",t._onMove),e.removeEventListener("mouseup",t._onEnd)})),t}updateContainerPosition(){var e=this.currentTarget,o=this.coors.container,r=e.getBoundingClientRect();return o.x=r.left+t.pageXOffset,o.y=r.top+t.pageYOffset,o.w=r.width,o.h=r.height,this}updatePointerPosition(t){var e=this.coors.pointer,o={x:t.pageX,y:t.pageY};return e.start||(e.start=o),e.end=o,this}updateNoosePosition(){var t=this.currentTarget,e=this.coors.pointer,o=this.coors.container,r=this.coors.noose;r.start||(r.start={x:e.start.x-o.x+t.scrollLeft,y:e.start.y-o.y+t.scrollTop});var s=e.end.x-o.x+t.scrollLeft,n=e.end.y-o.y+t.scrollTop;return r.top={x:Math.min(r.start.x,s),y:Math.min(r.start.y,n)},r.bottom={x:Math.max(r.start.x,s),y:Math.max(r.start.y,n)},this}compute(){var e=this;if(e.opts.select){var o=e.opts.classes.selected,r=e.currentTarget.querySelectorAll(e.opts.select),s=e.coors.noose.top,n=e.coors.noose.bottom,l=e.coors.container.x,c=e.coors.container.y;e.selected=[],Array.prototype.forEach.call(r,(function(r){if(r!==e.noose){var a=r.getBoundingClientRect(),i=a.left+t.pageXOffset-l+e.currentTarget.scrollLeft,u=a.top+t.pageYOffset-c+e.currentTarget.scrollTop,p=a.width+i,d=a.height+u;("fit"===e.opts.mode?s.x<=i&&s.y<=u&&n.x>=p&&n.y>=d:!(s.x>p||s.y>d||n.x<i||n.y<u))?(o&&r.classList.add(o),e.selected.push(r)):o&&r.classList.remove(o)}}))}return e}get version(){return"1.0.0"}}}),window,document);
//# sourceMappingURL=noose.js.map
