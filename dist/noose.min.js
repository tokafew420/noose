!function(t,e,o){"object"==typeof exports?module.exports=t(e,o):"function"==typeof define&&define.amd?define(()=>t(e,o)):e.Noose=t(e,o)}((function(t,e){"use strict";function o(){}const s=Math.min,r=Math.max,n={classes:{noose:"noose",selected:"selected"},compute:!0,container:"body",containers:[],ctrl:!0,detach:!0,enabled:!0,mode:"touch",move:o,scroll:10,scrollEdge:10,scrollbar:17,select:"*",shift:!0,start:o,stop:o,style:{border:"1px dotted #000",zIndex:1e3},throttle:200};return class{constructor(o,i){const l=this;if("object"!=typeof o||null==o||o instanceof HTMLElement||(i=o,o=null),i=l.opts=Object.assign({},n,i),("string"==typeof o||o instanceof HTMLElement)&&(i.container=o),i.container instanceof HTMLElement)l.containers=[i.container];else{if("string"!=typeof i.container)throw new Error("Invalid container option");l.containers=Array.prototype.slice.call(e.querySelectorAll(i.container))}l.coors={pointer:{},noose:{},container:{}};const c=l.noose=e.createElement("div");c.style.position="absolute",c.style.zIndex=i.style.zIndex,c.style.border=i.style.border,i.classes.noose&&c.classList.add(i.classes.noose);let a=!1,d=!1;return l._onStart=function(e){const o=e.currentTarget===l.currentTarget;if(i.enabled&&(!a||!o)&&("mousedown"!==e.type||1===e.which)){a=!0;const n=l.currentTarget=e.currentTarget,d=l.coors.container,u=l.coors.pointer,p=l.coors.noose,h=t.getComputedStyle(n);"static"===h.position&&console.warn("Container is not a positioned element. This may cause issues positioning the noose and/or selecting elements."),i.scroll>0&&i.scrollEdge>0?(d.scrollX=("auto"===h.overflowX||"scroll"===h.overflowX)&&n.scrollHeight>n.clientHeight,d.scrollY=("auto"===h.overflowY||"scroll"===h.overflowY)&&n.scrollWidth>n.clientWidth):(d.scrollX=!1,d.scrollY=!1),d.maxScrollY=d.scrollY&&n.scrollHeight-n.clientHeight||0,d.maxScrollX=d.scrollX&&n.scrollWidth-n.clientWidth||0;const y=u.start,f=u.end;if(u.start=null,p.start=null,l.updateContainerPosition().updatePointerPosition(e),i.scrollbar&&(d.scrollX&&u.end.x>d.x+d.w-i.scrollbar||d.scrollY&&u.end.y>d.y+d.h-i.scrollbar))return a=!1,u.start=y,void(u.end=f);if(i.shift&&o&&e.shiftKey&&y){const t=p.top,e=p.bottom,o=Math.floor((y.x+f.x)/2),n=Math.floor((y.y+f.y)/2);p.start={},u.start.x>=o&&u.start.y<n?(u.start.x=s(y.x,f.x),u.start.y=r(y.y,f.y),p.start.x=t.x,p.start.y=e.y):u.start.x<o&&u.start.y<=n?(u.start.x=r(y.x,f.x),u.start.y=r(y.y,f.y),p.start=e):u.start.x<=o&&u.start.y>n?(u.start.x=r(y.x,f.x),u.start.y=s(y.y,f.y),p.start.x=e.x,p.start.y=t.y):u.start.x>o&&u.start.y>=n&&(u.start.x=s(y.x,f.x),u.start.y=s(y.y,f.y),p.start=t)}if(i.ctrl&&o&&e.ctrlKey?l.lastSelection=l.selected||[]:l.lastSelection=[],c.style.display="none",!1===i.start.apply(l,[e,l.coors]))return a=!1,u.start=y,void(u.end=f);n.appendChild(c)}},l._onMove=function(t){if(i.enabled&&a&&t.currentTarget===l.currentTarget){t.cancelable&&t.preventDefault(),"scroll"!==t.type&&l.updatePointerPosition(t),l.updateContainerPosition().updateNoosePosition();let e=l.coors.noose.top,o=l.coors.noose.bottom;c.style.left=e.x+"px",c.style.top=e.y+"px",c.style.width=o.x-e.x+"px",c.style.height=o.y-e.y+"px",c.style.display="block";let s=l.currentTarget,r=l.coors.container,n=l.coors.pointer.end;r.scrollY&&n.y-r.y<i.scrollEdge?s.scrollTop-=i.scroll:r.scrollY&&s.scrollTop<r.maxScrollY&&r.y+r.h-n.y<i.scrollEdge?s.scrollTop+=i.scroll:r.scrollX&&n.x-r.x<i.scrollEdge?s.scrollLeft-=i.scroll:r.scrollX&&s.scrollLeft<r.maxScrollX&&r.x+r.w-n.x<i.scrollEdge&&(s.scrollLeft+=i.scroll),i.compute&&(i.throttle?d||(d=!0,setTimeout((function(){d&&l.compute()&&i.move.apply(l,[t,l.coors,l.selected]),d=!1}),i.throttle)):(l.compute(),i.move.apply(l,[t,l.coors,l.selected])))}},l._onEnd=function(t){l.opts.enabled&&a&&("mouseup"!==t.type||1===t.which)&&(a=!1,t.currentTarget===l.currentTarget&&(l.updateContainerPosition().updatePointerPosition(t).updateNoosePosition(),d=!1,i.compute&&l.compute(!0),setTimeout((function(){i.stop.apply(l,[t,l.coors,l.selected])}),0),i.detach&&l.currentTarget.removeChild(c)))},l.containers.forEach(t=>{l._register(t)}),l}destroy(){const t=this;return t.containers.forEach(e=>{t._deregister(e)}),t.noose.remove(),t.noose=null,t}updateContainerPosition(){const e=this.coors.container,o=this.currentTarget.getBoundingClientRect();return e.x=o.left+t.pageXOffset,e.y=o.top+t.pageYOffset,e.w=o.width,e.h=o.height,this}updatePointerPosition(t){const e=t&&t.touches&&t.touches[0]||t,o=this.coors.pointer;return e&&"number"==typeof e.pageX&&(o.end={x:e.pageX,y:e.pageY},o.start||(o.start=o.end)),this}updateNoosePosition(){const t=this.currentTarget,e=this.coors.pointer.end,o=this.coors.container,n=this.coors.noose,i=r(e.x-o.x+t.scrollLeft,0),l=r(e.y-o.y+t.scrollTop,0);return n.start||(n.start={x:i,y:l}),n.top={x:s(n.start.x,i),y:s(n.start.y,l)},n.bottom={x:s(r(n.start.x,i),t.scrollWidth),y:s(r(n.start.y,l),t.scrollHeight)},this}compute(){const e=this;if(e.opts.select){const o=e.opts.classes.selected,s=e.currentTarget,r=s.querySelectorAll(e.opts.select),n=e.coors.noose.top,i=e.coors.noose.bottom,l=e.coors.container.x,c=e.coors.container.y;e.selected=[],Array.prototype.forEach.call(r,(function(r){if(r===e.noose)return;let a;const d=r.getBoundingClientRect(),u=d.left+t.pageXOffset-l+s.scrollLeft,p=d.top+t.pageYOffset-c+s.scrollTop,h=d.width+u,y=d.height+p;a="fit"===e.opts.mode?n.x<=u&&n.y<=p&&i.x>=h&&i.y>=y:!(n.x>h||n.y>y||i.x<u||i.y<p);const f=e.lastSelection.indexOf(r);a&&-1===f||!a&&-1!==f?(o&&r.classList.add(o),e.selected.push(r)):o&&r.classList.remove(o)}))}return e}_deregister(t){return t.removeEventListener("mousedown",this._onStart),t.removeEventListener("touchstart",this._onStart),t.removeEventListener("mousemove",this._onMove),t.removeEventListener("touchmove",this._onMove),t.removeEventListener("scroll",this._onMove),t.removeEventListener("mouseup",this._onEnd),t.removeEventListener("touchend",this._onEnd),delete t.noose,this}deregister(t){var e=this.containers.indexOf(t);return e>-1&&"function"==typeof t.removeEventListener&&(this._deregister(t),this.containers.splice(e,1)),this}_register(t){return t.addEventListener("mousedown",this._onStart),t.addEventListener("touchstart",this._onStart,!1),t.addEventListener("mousemove",this._onMove),t.addEventListener("touchmove",this._onMove,!1),t.addEventListener("scroll",this._onMove),t.addEventListener("mouseup",this._onEnd),t.addEventListener("touchend",this._onEnd,!1),t.noose=this}register(t){return-1===this.containers.indexOf(t)&&"function"==typeof t.addEventListener&&(this._register(t),this.containers.push(t)),this}static get version(){return"1.2.2"}}}),window,document);
//# sourceMappingURL=noose.js.map
