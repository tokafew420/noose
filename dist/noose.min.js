!function(t,e,o){"object"==typeof exports?module.exports=t(e,o):"function"==typeof define&&define.amd?define(()=>t(e,o)):e.Noose=t(e,o)}((function(t,e){"use strict";function o(){}const r={container:"body",classes:{noose:"",selected:"selected"},enabled:!0,mode:"touch",scroll:10,scrollEdge:10,scrollbar:17,select:"*",start:o,stop:o,style:{border:"1px dotted #000",zIndex:1e3},throttle:200};return class{constructor(o,n){var s=this;if("object"!=typeof o||null==o||o instanceof Element||(n=o,o=null),n=s.opts=Object.assign({},r,n),("string"==typeof o||o instanceof Element)&&(n.container=o),n.container instanceof Element)s.containers=[n.container];else{if("string"!=typeof n.container)throw new Error("Invalid container option");s.containers=e.querySelectorAll(n.container)}s.coors={pointer:{start:null,end:null},noose:{top:null,bottom:null},container:{}};var l=s.noose=e.createElement("div");l.style.position="absolute",l.style.zIndex=s.opts.style.zIndex,l.style.border=s.opts.style.border,n.classes.noose&&l.classList.add(s.opts.classes.noose);var c=!1,a=!1;return s._onStart=function(e){if(s.opts.enabled&&(!c||e.currentTarget!==s.currentTarget)&&("mousedown"!==e.type||1===e.which)){c=!0,s.currentTarget=e.currentTarget;var o=t.getComputedStyle(s.currentTarget);"static"===o.position&&console.warn("Container is not a positioned element. This may cause issues positioning the noose and/or selecting elements.");var r=s.coors.container,n=s.coors.pointer,l=s.coors.noose;if(s.opts.scroll>0&&s.opts.scrollEdge>0?(r.scrollX=("auto"===o.overflowX||"scroll"===o.overflowX)&&s.currentTarget.scrollHeight>s.currentTarget.clientHeight,r.scrollY=("auto"===o.overflowY||"scroll"===o.overflowY)&&s.currentTarget.scrollWidth>s.currentTarget.clientWidth):(r.scrollX=!1,r.scrollY=!1),r.maxScrollY=r.scrollY&&s.currentTarget.scrollHeight-s.currentTarget.clientHeight||0,r.maxScrollX=r.scrollX&&s.currentTarget.scrollWidth-s.currentTarget.clientWidth||0,n.start=null,l.start=null,s.updateContainerPosition().updatePointerPosition(e),s.opts.scrollbar&&(r.scrollX&&n.start.x>r.x+r.w-s.opts.scrollbar||r.scrollY&&n.start.y>r.y+r.h-s.opts.scrollbar))return void(c=!1);if(s.noose.style.display="none",!1===s.opts.start.apply(s,[e,s.coors])||e.defaultPrevented)return void(c=!1);s.currentTarget.appendChild(s.noose)}},s._onMove=function(t){if(s.opts.enabled&&c&&t.currentTarget===s.currentTarget){t.preventDefault(),"scroll"!==t.type&&s.updatePointerPosition(t),s.updateContainerPosition().updateNoosePosition();var e=s.coors.noose.top,o=s.coors.noose.bottom;s.noose.style.left=e.x+"px",s.noose.style.top=e.y+"px",s.noose.style.width=o.x-e.x+"px",s.noose.style.height=o.y-e.y+"px",s.noose.style.display="block";var r=s.coors.container,n=s.coors.pointer.end;r.scrollY&&n.y-r.y<10?s.currentTarget.scrollTop-=s.opts.scroll:r.scrollY&&s.currentTarget.scrollTop<r.maxScrollY&&r.y+r.h-n.y<10?s.currentTarget.scrollTop+=s.opts.scroll:r.scrollX&&n.x-r.x<10?s.currentTarget.scrollLeft-=s.opts.scroll:r.scrollX&&s.currentTarget.scrollLeft<r.maxScrollX&&r.x+r.w-n.x<10&&(s.currentTarget.scrollLeft+=s.opts.scroll),s.opts.throttle?a||(a=!0,setTimeout((function(){s.compute(),a=!1}),s.opts.throttle)):s.compute()}},s._onEnd=function(t){s.opts.enabled&&c&&("mouseup"!==t.type||1===t.which)&&(c=!1,t.currentTarget===s.currentTarget&&(s.updateContainerPosition().updatePointerPosition(t).updateNoosePosition(),s.compute(),setTimeout((function(){s.opts.stop.apply(s,[t,s.coors,s.selected])}),0),s.currentTarget.removeChild(s.noose)))},Array.prototype.forEach.call(s.containers,(function(t){t.addEventListener("mousedown",s._onStart),t.addEventListener("touchstart",s._onStart),t.addEventListener("mousemove",s._onMove),t.addEventListener("touchmove",s._onMove),t.addEventListener("scroll",s._onMove),t.addEventListener("mouseup",s._onEnd),t.addEventListener("touchend",s._onEnd)})),s}destroy(){var t=this;return t.containers.forEach((function(e){e.removeEventListener("mousedown",t._onStart),e.removeEventListener("touchstart",t._onStart),e.removeEventListener("mousemove",t._onMove),e.removeEventListener("touchmove",t._onMove),e.removeEventListener("scroll",t._onMove),e.removeEventListener("mouseup",t._onEnd),e.removeEventListener("touchend",t._onEnd)})),t}updateContainerPosition(){var e=this.currentTarget,o=this.coors.container,r=e.getBoundingClientRect();return o.x=r.left+t.pageXOffset,o.y=r.top+t.pageYOffset,o.w=r.width,o.h=r.height,this}updatePointerPosition(t){var e=t&&t.touches&&t.touches[0]||t,o=this.coors.pointer;if(e&&"number"==typeof e.pageX){var r={x:e.pageX,y:e.pageY};o.start||(o.start=r),o.end=r}return this}updateNoosePosition(){var t=this.currentTarget,e=this.coors.pointer,o=this.coors.container,r=this.coors.noose;r.start||(r.start={x:e.start.x-o.x+t.scrollLeft,y:e.start.y-o.y+t.scrollTop});var n=e.end.x-o.x+t.scrollLeft,s=e.end.y-o.y+t.scrollTop;return r.top={x:Math.min(r.start.x,n),y:Math.min(r.start.y,s)},r.bottom={x:Math.max(r.start.x,n),y:Math.max(r.start.y,s)},this}compute(){var e=this;if(e.opts.select){var o=e.opts.classes.selected,r=e.currentTarget.querySelectorAll(e.opts.select),n=e.coors.noose.top,s=e.coors.noose.bottom,l=e.coors.container.x,c=e.coors.container.y;e.selected=[],Array.prototype.forEach.call(r,(function(r){if(r!==e.noose){var a=r.getBoundingClientRect(),i=a.left+t.pageXOffset-l+e.currentTarget.scrollLeft,u=a.top+t.pageYOffset-c+e.currentTarget.scrollTop,p=a.width+i,d=a.height+u;("fit"===e.opts.mode?n.x<=i&&n.y<=u&&s.x>=p&&s.y>=d:!(n.x>p||n.y>d||s.x<i||s.y<u))?(o&&r.classList.add(o),e.selected.push(r)):o&&r.classList.remove(o)}}))}return e}get version(){return"1.0.0"}}}),window,document);
//# sourceMappingURL=noose.js.map
