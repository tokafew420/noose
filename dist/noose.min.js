!function(e,t,o){"object"==typeof exports?module.exports=e(t,o):"function"==typeof define&&define.amd?define(()=>e(t,o)):t.Noose=e(t,o)}((function(e,t){"use strict";function o(){}const n={classes:{noose:"noose",selected:"selected"},compute:!0,container:"body",enabled:!0,mode:"touch",scroll:10,scrollEdge:10,scrollbar:17,select:"*",start:o,stop:o,style:{border:"1px dotted #000",zIndex:1e3},throttle:200};return class{constructor(o,r){const s=this;if("object"!=typeof o||null==o||o instanceof HTMLElement||(r=o,o=null),r=s.opts=Object.assign({},n,r),("string"==typeof o||o instanceof HTMLElement)&&(r.container=o),r.container instanceof HTMLElement)s.containers=[r.container];else{if("string"!=typeof r.container)throw new Error("Invalid container option");s.containers=t.querySelectorAll(r.container)}s.coors={pointer:{start:null,end:{}},noose:{top:null,bottom:null},container:{}};const l=s.noose=t.createElement("div");l.style.position="absolute",l.style.zIndex=r.style.zIndex,l.style.border=r.style.border,r.classes.noose&&l.classList.add(r.classes.noose);let c=!1,i=!1;return s._onStart=function(t){if(r.enabled&&(!c||t.currentTarget!==s.currentTarget)&&("mousedown"!==t.type||1===t.which)){c=!0;const o=s.currentTarget=t.currentTarget,n=s.coors.container,i=s.coors.pointer,a=s.coors.noose,d=e.getComputedStyle(o);if("static"===d.position&&console.warn("Container is not a positioned element. This may cause issues positioning the noose and/or selecting elements."),r.scroll>0&&r.scrollEdge>0?(n.scrollX=("auto"===d.overflowX||"scroll"===d.overflowX)&&o.scrollHeight>o.clientHeight,n.scrollY=("auto"===d.overflowY||"scroll"===d.overflowY)&&o.scrollWidth>o.clientWidth):(n.scrollX=!1,n.scrollY=!1),n.maxScrollY=n.scrollY&&o.scrollHeight-o.clientHeight||0,n.maxScrollX=n.scrollX&&o.scrollWidth-o.clientWidth||0,i.start=null,a.start=null,s.updateContainerPosition().updatePointerPosition(t),r.scrollbar&&(n.scrollX&&i.start.x>n.x+n.w-r.scrollbar||n.scrollY&&i.start.y>n.y+n.h-r.scrollbar))return void(c=!1);if(l.style.display="none",!1===r.start.apply(s,[t,s.coors]))return void(c=!1);o.appendChild(l)}},s._onMove=function(e){if(r.enabled&&c&&e.currentTarget===s.currentTarget){e.cancelable&&e.preventDefault(),"scroll"!==e.type&&s.updatePointerPosition(e),s.updateContainerPosition().updateNoosePosition();let t=s.coors.noose.top,o=s.coors.noose.bottom;l.style.left=t.x+"px",l.style.top=t.y+"px",l.style.width=o.x-t.x+"px",l.style.height=o.y-t.y+"px",l.style.display="block";let n=s.currentTarget,c=s.coors.container,a=s.coors.pointer.end;c.scrollY&&a.y-c.y<r.scrollEdge?n.scrollTop-=r.scroll:c.scrollY&&n.scrollTop<c.maxScrollY&&c.y+c.h-a.y<r.scrollEdge?n.scrollTop+=r.scroll:c.scrollX&&a.x-c.x<r.scrollEdge?n.scrollLeft-=r.scroll:c.scrollX&&n.scrollLeft<c.maxScrollX&&c.x+c.w-a.x<r.scrollEdge&&(n.scrollLeft+=r.scroll),r.compute&&(r.throttle?i||(i=!0,setTimeout((function(){s.compute(),i=!1}),r.throttle)):s.compute())}},s._onEnd=function(e){s.opts.enabled&&c&&("mouseup"!==e.type||1===e.which)&&(c=!1,e.currentTarget===s.currentTarget&&(s.updateContainerPosition().updatePointerPosition(e).updateNoosePosition(),r.compute&&s.compute(),setTimeout((function(){r.stop.apply(s,[e,s.coors,s.selected])}),0),s.currentTarget.removeChild(l)))},Array.prototype.forEach.call(s.containers,(function(e){e.addEventListener("mousedown",s._onStart),e.addEventListener("touchstart",s._onStart,!1),e.addEventListener("mousemove",s._onMove),e.addEventListener("touchmove",s._onMove,!1),e.addEventListener("scroll",s._onMove),e.addEventListener("mouseup",s._onEnd),e.addEventListener("touchend",s._onEnd,!1),e.noose=s})),s}destroy(){const e=this;return e.containers.forEach((function(t){t.removeEventListener("mousedown",e._onStart),t.removeEventListener("touchstart",e._onStart),t.removeEventListener("mousemove",e._onMove),t.removeEventListener("touchmove",e._onMove),t.removeEventListener("scroll",e._onMove),t.removeEventListener("mouseup",e._onEnd),t.removeEventListener("touchend",e._onEnd),delete t.noose})),e.noose.remove(),e.noose=null,e}updateContainerPosition(){const t=this.coors.container,o=this.currentTarget.getBoundingClientRect();return t.x=o.left+e.pageXOffset,t.y=o.top+e.pageYOffset,t.w=o.width,t.h=o.height,this}updatePointerPosition(e){const t=e&&e.touches&&e.touches[0]||e,o=this.coors.pointer;return t&&"number"==typeof t.pageX&&(o.end={x:t.pageX,y:t.pageY},o.start||(o.start=o.end)),this}updateNoosePosition(){const e=this.currentTarget,t=this.coors.pointer,o=this.coors.container,n=this.coors.noose,r=Math.max(t.end.x-o.x+e.scrollLeft,0),s=Math.max(t.end.y-o.y+e.scrollTop,0);return n.start||(n.start={x:r,y:s}),n.top={x:Math.min(n.start.x,r),y:Math.min(n.start.y,s)},n.bottom={x:Math.min(Math.max(n.start.x,r),e.scrollWidth),y:Math.min(Math.max(n.start.y,s),e.scrollHeight)},this}compute(){const t=this;if(t.opts.select){const o=t.opts.classes.selected,n=t.currentTarget.querySelectorAll(t.opts.select),r=t.coors.noose.top,s=t.coors.noose.bottom,l=t.coors.container.x,c=t.coors.container.y;t.selected=[],Array.prototype.forEach.call(n,(function(n){if(n===t.noose)return;let i=!1;const a=n.getBoundingClientRect(),d=a.left+e.pageXOffset-l+t.currentTarget.scrollLeft,u=a.top+e.pageYOffset-c+t.currentTarget.scrollTop,p=a.width+d,h=a.height+u;(i="fit"===t.opts.mode?r.x<=d&&r.y<=u&&s.x>=p&&s.y>=h:!(r.x>p||r.y>h||s.x<d||s.y<u))?(o&&n.classList.add(o),t.selected.push(n)):o&&n.classList.remove(o)}))}return t}static get version(){return"1.1.5"}}}),window,document);
//# sourceMappingURL=noose.js.map
